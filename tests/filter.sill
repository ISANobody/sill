stype Stream a = &{stop: 1; next: a /\ Stream a};;

filter: {Stream a <- Stream a};;
'c <- filter -< 'd = 
 case 'c of
 | stop -> 'd.stop;
           wait 'd;
           close 'c
 | next -> 'd.next;
           x <- recv 'd;
           send 'c x;
          'e <- filter -< 'd;
          'c <- 'e;;


'c <- close 'c;;
