foo : { 1 <- @1 };;
'c <- foo -< @d =
  'e <- send @d;
  wait 'e;
  close 'c;;

atype Foo = 1;;

bar : { 'Foo };;
'c <- bar =
  send 'c (@d <- close @d);;

baz : { 1 <- 'Foo };;
'c <- baz -< 'd =
  @e <- recv 'd;
  close 'c;;

quux : { @1 };;
@c <- quux = 
  'd <- recv @c;
  close 'd;;

brillig : { '!1 };;
'c <- brillig =
  send 'c (!u <- 
                'd <- recv !u; 
                close 'd);;

'top <- 'c <- brillig;
        !d <- recv 'c;
        'e <- send !d;
        'f <- send !d;
        wait 'e;
        wait 'f;
        close 'top;;

slithy : { '@1 };;
'c <- slithy =
  send 'c (@a <- 
                 'd <- recv @a;
                 close 'd);;

'top <- 'c <- slithy;
        @a <- recv 'c;
        'd <- send @a;
        wait 'd;
        close 'top;;
